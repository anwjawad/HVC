<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HomeVisits Premium</title>

    <!-- Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&family=Outfit:wght@300;400;500;600&display=swap"
        rel="stylesheet">
    <link rel="icon" href="assets/icon.png" type="image/png">

    <!-- Icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Outfit', 'sans-serif'],
                        display: ['Montserrat', 'sans-serif'],
                    },
                    colors: {
                        primary: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            900: '#0c4a6e',
                        },
                        glass: {
                            100: 'rgba(255, 255, 255, 0.1)',
                            200: 'rgba(255, 255, 255, 0.2)',
                            300: 'rgba(255, 255, 255, 0.3)',
                        }
                    }
                }
            }
        }
    </script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css">
</head>

<body class="bg-slate-50 text-slate-800 antialiased relative overflow-x-hidden min-h-screen">

    <!-- Background Gradients -->
    <div class="fixed top-0 left-0 w-full h-full overflow-hidden -z-10 pointer-events-none">
        <div
            class="absolute top-[-10%] left-[-10%] w-[50%] h-[50%] bg-blue-400 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob">
        </div>
        <div
            class="absolute top-[-10%] right-[-10%] w-[50%] h-[50%] bg-purple-400 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob animation-delay-2000">
        </div>
        <div
            class="absolute bottom-[-10%] left-[20%] w-[50%] h-[50%] bg-pink-400 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob animation-delay-4000">
        </div>
        <div
            class="absolute bottom-[10%] right-[10%] w-[40%] h-[40%] bg-amber-200 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob animation-delay-3000">
        </div>
    </div>

    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-50 glass-nav border-b border-white/20">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">
                <div class="flex items-center gap-3">
                    <div
                        class="w-10 h-10 rounded-xl bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center text-white shadow-lg shadow-blue-500/30">
                        <i class="fa-solid fa-house-medical text-lg"></i>
                    </div>
                    <span class="font-display font-bold text-xl tracking-tight text-slate-800">Home<span
                            class="text-blue-600">Visits</span></span>
                </div>

                <div class="hidden md:flex items-center space-x-8">
                    <button onclick="showSection('dashboard')" class="nav-link active"
                        data-section="dashboard">Dashboard</button>
                    <button onclick="showSection('register')" class="nav-link" data-section="register">New
                        Patient</button>
                    <button onclick="showSection('list')" class="nav-link" data-section="list">Visits List</button>
                    <button onclick="showSection('analysis')" class="nav-link" data-section="analysis">Analysis</button>
                    <button onclick="openSettings()" class="text-slate-400 hover:text-blue-600 transition-colors"><i
                            class="fa-solid fa-gear"></i></button>
                </div>

                <!-- Mobile Menu Button -->
                <div class="md:hidden">
                    <button onclick="toggleMobileMenu()" class="text-slate-600 hover:text-blue-600 p-2">
                        <i class="fa-solid fa-bars text-xl"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden bg-white/95 backdrop-blur-xl border-t border-slate-200">
            <div class="px-4 py-4 space-y-2">
                <button onclick="showSection('dashboard'); toggleMobileMenu()"
                    class="nav-link-mobile w-full text-left p-3 rounded-lg text-slate-600 font-medium hover:bg-blue-50 hover:text-blue-600 transition-colors">
                    <i class="fa-solid fa-chart-pie w-6"></i> Dashboard
                </button>
                <button onclick="showSection('register'); toggleMobileMenu()"
                    class="nav-link-mobile w-full text-left p-3 rounded-lg text-slate-600 font-medium hover:bg-blue-50 hover:text-blue-600 transition-colors">
                    <i class="fa-solid fa-user-plus w-6"></i> New Patient
                </button>
                <button onclick="showSection('list'); toggleMobileMenu()"
                    class="nav-link-mobile w-full text-left p-3 rounded-lg text-slate-600 font-medium hover:bg-blue-50 hover:text-blue-600 transition-colors">
                    <i class="fa-solid fa-clipboard-list w-6"></i> Visits List
                </button>
                <button onclick="showSection('analysis'); toggleMobileMenu()"
                    class="nav-link-mobile w-full text-left p-3 rounded-lg text-slate-600 font-medium hover:bg-blue-50 hover:text-blue-600 transition-colors">
                    <i class="fa-solid fa-chart-line w-6"></i> Analysis
                </button>
                <button onclick="openSettings(); toggleMobileMenu()"
                    class="nav-link-mobile w-full text-left p-3 rounded-lg text-slate-600 font-medium hover:bg-blue-50 hover:text-blue-600 transition-colors">
                    <i class="fa-solid fa-gear w-6"></i> Settings
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="pt-24 pb-12 px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto min-h-screen">

        <!-- Dashboard Section -->
        <section id="dashboard" class="page-section animate-fade-in">
            <header class="mb-8">
                <h1 class="text-3xl font-display font-bold text-slate-900">Dashboard</h1>
                <p class="text-slate-500">Real-time program analytics across <span id="dash-total-badge"
                        class="font-bold text-blue-600">--</span> patients.</p>
            </header>

            <!-- 1. Key Metrics Row -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6 mb-8">
                <!-- Total -->
                <div class="glass-card p-6 rounded-2xl relative overflow-hidden group">
                    <div class="relative z-10">
                        <p class="text-xs font-bold uppercase tracking-wider text-slate-400 mb-1">Total Census</p>
                        <h3 class="text-4xl font-display font-bold text-slate-800" id="stat-total">--</h3>
                        <p class="text-xs text-slate-400 mt-2">All registered</p>
                    </div>
                    <div
                        class="absolute -right-4 -bottom-4 text-slate-100 group-hover:text-blue-50 transition-colors duration-500">
                        <i class="fa-solid fa-users text-8xl"></i>
                    </div>
                </div>

                <!-- Active -->
                <div class="glass-card p-6 rounded-2xl relative overflow-hidden group">
                    <div class="relative z-10">
                        <p class="text-xs font-bold uppercase tracking-wider text-green-600 mb-1">Active Patients</p>
                        <h3 class="text-4xl font-display font-bold text-slate-800" id="stat-active">--</h3>
                        <p class="text-xs text-slate-400 mt-2">Survival: Alive</p>
                    </div>
                    <div
                        class="absolute -right-4 -bottom-4 text-green-50/50 group-hover:text-green-100 transition-colors duration-500">
                        <i class="fa-solid fa-heart-pulse text-8xl"></i>
                    </div>
                </div>

                <!-- Died -->
                <div class="glass-card p-6 rounded-2xl relative overflow-hidden group">
                    <div class="relative z-10">
                        <p class="text-xs font-bold uppercase tracking-wider text-slate-500 mb-1">Passed Away</p>
                        <h3 class="text-4xl font-display font-bold text-slate-800" id="stat-died">--</h3>
                        <p class="text-xs text-slate-400 mt-2">Survival: Died</p>
                    </div>
                    <div
                        class="absolute -right-4 -bottom-4 text-slate-100 group-hover:text-slate-200 transition-colors duration-500">
                        <i class="fa-solid fa-ribbon text-8xl"></i>
                    </div>
                </div>

                <!-- Priority -->
                <div class="glass-card p-6 rounded-2xl relative overflow-hidden group">
                    <div class="relative z-10">
                        <p class="text-xs font-bold uppercase tracking-wider text-amber-600 mb-1">High Priority</p>
                        <h3 class="text-4xl font-display font-bold text-slate-800" id="stat-priority">--</h3>
                        <p class="text-xs text-slate-400 mt-2">Priority Level 1</p>
                    </div>
                    <div
                        class="absolute -right-4 -bottom-4 text-amber-50/50 group-hover:text-amber-100 transition-colors duration-500">
                        <i class="fa-solid fa-star text-8xl"></i>
                    </div>
                </div>

                <!-- Visits (Aggregate) -->
                <div class="glass-card p-6 rounded-2xl relative overflow-hidden group">
                    <div class="relative z-10">
                        <p class="text-xs font-bold uppercase tracking-wider text-purple-600 mb-1">Total Visits</p>
                        <h3 class="text-4xl font-display font-bold text-slate-800" id="stat-visits">--</h3>
                        <p class="text-xs text-slate-400 mt-2">Completed visits</p>
                    </div>
                    <div
                        class="absolute -right-4 -bottom-4 text-purple-50/50 group-hover:text-purple-100 transition-colors duration-500">
                        <i class="fa-solid fa-person-walking-luggage text-8xl"></i>
                    </div>
                </div>
            </div>

            <!-- 2. Main Analytics Grid -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">

                <!-- Clinical Breakdown (Diagnosis) -->
                <div class="glass-card p-6 rounded-2xl lg:col-span-2 flex flex-col">
                    <h3 class="text-lg font-bold text-slate-800 mb-6 flex items-center gap-2">
                        <i class="fa-solid fa-chart-pie text-blue-500"></i> Diagnosis Distribution
                    </h3>
                    <div class="flex-1 relative min-h-[300px]">
                        <canvas id="chart-diagnosis"></canvas>
                    </div>
                </div>

                <!-- Demographics (Gender) -->
                <div class="glass-card p-6 rounded-2xl flex flex-col">
                    <h3 class="text-lg font-bold text-slate-800 mb-6 flex items-center gap-2">
                        <i class="fa-solid fa-venus-mars text-pink-500"></i> Gender Split
                    </h3>
                    <div class="flex-1 relative min-h-[200px] flex items-center justify-center">
                        <canvas id="chart-gender"></canvas>
                    </div>
                </div>
            </div>

            <!-- 3. Deep Analysis Section -->
            <h2 class="text-xl font-display font-bold text-slate-800 mb-4 pl-1 border-l-4 border-indigo-500">Deep
                Analysis</h2>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                <!-- Geo Distribution -->
                <div class="glass-card p-6 rounded-2xl">
                    <h3 class="text-sm font-bold text-slate-500 uppercase mb-4">Geographic Coverage</h3>
                    <div class="relative h-[250px]">
                        <canvas id="chart-geo"></canvas>
                    </div>
                </div>

                <!-- Intent of Care -->
                <div class="glass-card p-6 rounded-2xl">
                    <h3 class="text-sm font-bold text-slate-500 uppercase mb-4">Intent of Care</h3>
                    <div class="relative h-[250px]">
                        <canvas id="chart-intent"></canvas>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <!-- Source of Referral -->
                <div class="glass-card p-6 rounded-2xl">
                    <h3 class="text-sm font-bold text-slate-500 uppercase mb-4">Referral Sources</h3>
                    <div class="relative h-[200px]">
                        <canvas id="chart-referral"></canvas>
                    </div>
                </div>
                <!-- Stage -->
                <div class="glass-card p-6 rounded-2xl">
                    <h3 class="text-sm font-bold text-slate-500 uppercase mb-4">Disease Stage</h3>
                    <div class="relative h-[200px]">
                        <canvas id="chart-stage"></canvas>
                    </div>
                </div>
                <!-- Social Status -->
                <div class="glass-card p-6 rounded-2xl">
                    <h3 class="text-sm font-bold text-slate-500 uppercase mb-4">Social Status</h3>
                    <div class="relative h-[200px]">
                        <canvas id="chart-social"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- Registration Section -->
        <section id="register" class="page-section hidden animate-fade-in">
            <header class="mb-8 flex justify-between items-end">
                <div>
                    <h1 class="text-3xl font-display font-bold text-slate-900">New Patient</h1>
                    <p class="text-slate-500">Register a new patient for home visit</p>
                </div>
            </header>

            <div class="glass-card p-8 rounded-3xl border border-white/50 shadow-xl">
                <form id="reg-form" class="space-y-8">
                    <!-- Section 1: Demographics -->
                    <div>
                        <h3 class="text-lg font-semibold text-blue-600 mb-4 flex items-center gap-2">
                            <i class="fa-regular fa-id-card"></i> Demographics
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            <div class="form-group">
                                <label>Pt Name</label>
                                <input type="text" name="Pt Name" required class="input-field" placeholder="Full Name">
                            </div>
                            <div class="form-group">
                                <label>Pt file Num.</label>
                                <input type="text" name="Pt file Num." required class="input-field"
                                    placeholder="ID / File No.">
                            </div>
                            <div class="form-group">
                                <label>Gender</label>
                                <select name="Gender" class="input-field">
                                    <option value="">Select...</option>
                                    <option value="Male">Male</option>
                                    <option value="Female">Female</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Age</label>
                                <input type="number" name="Age" class="input-field" placeholder="Years">
                            </div>
                            <div class="form-group">
                                <label>phone No.</label>
                                <input type="tel" name="phone No." class="input-field" placeholder="05...">
                            </div>
                            <div class="form-group">
                                <label>Social Status</label>
                                <select name="Social status" class="input-field">
                                    <option value="">Select...</option>
                                    <option value="Married">Married</option>
                                    <option value="Single">Single</option>
                                </select>
                            </div>
                            <!-- Address Fields -->
                            <div class="form-group">
                                <label>City/Area (Adress)</label>
                                <select name="Adress" class="input-field">
                                    <option value="">Select Area...</option>
                                    <option value="Hebron">Hebron</option>
                                    <option value="Jericho">Jericho</option>
                                    <option value="Jerusalem">Jerusalem</option>
                                    <option value="Bethlehem">Bethlehem</option>
                                    <option value="Ramallah">Ramallah</option>
                                    <option value="Nablus">Nablus</option>
                                    <option value="Jenin">Jenin</option>
                                    <option value="Tulkarm">Tulkarm</option>
                                    <option value="Qalqilya">Qalqilya</option>
                                    <option value="Salfit">Salfit</option>
                                </select>
                            </div>
                            <div class="form-group md:col-span-2">
                                <label>Specific Home Address</label>
                                <input type="text" name="Home Address " class="input-field"
                                    placeholder="Street, Building, details...">
                            </div>
                        </div>
                    </div>

                    <div class="h-px bg-slate-200"></div>

                    <!-- Section 2: Clinical Info -->
                    <div>
                        <h3 class="text-lg font-semibold text-purple-600 mb-4 flex items-center gap-2">
                            <i class="fa-solid fa-stethoscope"></i> Clinical Info
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            <div class="form-group">
                                <label>Hospital</label>
                                <select name="Hospital" class="input-field">
                                    <option value="">Select...</option>
                                    <option value="AVH">AVH</option>
                                    <option value="Service">Service</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Primary Physician</label>
                                <select name="Primary Physicien" class="input-field">
                                    <option value="">Select Doctor...</option>
                                    <option value="Amer Zughaier">Amer Zughaier</option>
                                    <option value="Bashir Abu Aqeel">Bashir Abu Aqeel</option>
                                    <option value="Fadel Rawashdeh">Fadel Rawashdeh</option>
                                    <option value="Fadi Al Atrash">Fadi Al Atrash</option>
                                    <option value="Farah Awad">Farah Awad</option>
                                    <option value="Hamdi Janazreh">Hamdi Janazreh</option>
                                    <option value="Hanna Qahoush">Hanna Qahoush</option>
                                    <option value="Ibraheem Eid">Ibraheem Eid</option>
                                    <option value="Jalal Qawasmi">Jalal Qawasmi</option>
                                    <option value="Moath Badawi">Moath Badawi</option>
                                    <option value="Ola Abu Laban">Ola Abu Laban</option>
                                    <option value="Salem Ballan">Salem Ballan</option>
                                    <option value="Waseem Sharabate">Waseem Sharabate</option>
                                    <option value="Yousef Hammamreh">Yousef Hammamreh</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Diagnosis</label>
                                <select name="Diagnosis" class="input-field">
                                    <option value="">Select Diagnosis...</option>
                                    <option value="Brain Cancers">Brain Cancers</option>
                                    <option value="Breast Cancers">Breast Cancers</option>
                                    <option value="Colorectal cancers">Colorectal cancers</option>
                                    <option value="Endocrine Cancers">Endocrine Cancers</option>
                                    <option value="Gastric Cancers">Gastric Cancers</option>
                                    <option value="Genitourinary Cancers">Genitourinary Cancers</option>
                                    <option value="Gynecological Cancers">Gynecological Cancers</option>
                                    <option value="Head and Neck Cancers">Head and Neck Cancers</option>
                                    <option value="Hematological cancer">Hematological cancer</option>
                                    <option value="Lung Cancers">Lung Cancers</option>
                                    <option value="Lymphomas">Lymphomas</option>
                                    <option value="Panceriatic cancer">Panceriatic cancer</option>
                                    <option value="Prostate Cancers">Prostate Cancers</option>
                                    <option value="Rare and Mixed Cancers">Rare and Mixed Cancers</option>
                                    <option value="Sarcomas">Sarcomas</option>
                                </select>
                            </div>
                            <div class="form-group md:col-span-2">
                                <label>Specific Diagnosis</label>
                                <input type="text" name="Specific Diagnosis" class="input-field"
                                    placeholder="Detail...">
                            </div>
                            <div class="form-group">
                                <label>Stage of Disease</label>
                                <select name="Stage of Disease" class="input-field">
                                    <option value="">Select...</option>
                                    <option value="NED">NED</option>
                                    <option value="Stage 1">Stage 1</option>
                                    <option value="Stage 2">Stage 2</option>
                                    <option value="Stage 3">Stage 3</option>
                                    <option value="Stage 4">Stage 4</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Intent of care</label>
                                <select name="Intent of care" class="input-field">
                                    <option value="">Select...</option>
                                    <option value="Palliative Care">Palliative Care</option>
                                    <option value="Curative">Curative</option>
                                    <option value="End of Life">End of Life</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Opioid?</label>
                                <select name="opioid " class="input-field">
                                    <option value="No">No</option>
                                    <option value="Yes">Yes</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="h-px bg-slate-200"></div>

                    <!-- Section 3: Status & Referral -->
                    <div>
                        <h3 class="text-lg font-semibold text-amber-600 mb-4 flex items-center gap-2">
                            <i class="fa-solid fa-clipboard-check"></i> Status & Referral
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                            <div class="form-group">
                                <label>Priority</label>
                                <select name="priority" class="input-field">
                                    <option value="">Select...</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Site of Referral</label>
                                <select name="Site of Referral" class="input-field">
                                    <option value="">Select...</option>
                                    <option value="Primary Dr">Primary Dr</option>
                                    <option value="Department">Department</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>ECOG</label>
                                <input type="number" name="ECOG" class="input-field" min="0" max="4">
                            </div>
                            <div class="form-group">
                                <label>PPI</label>
                                <input type="number" name="PPI" class="input-field">
                            </div>
                            <div class="form-group">
                                <label>PPS</label>
                                <input type="number" name="PPS" class="input-field">
                            </div>
                            <div class="form-group">
                                <label>Number of visits</label>
                                <input type="number" name="number of visits" class="input-field" value="0">
                            </div>
                        </div>
                    </div>

                    <div class="h-px bg-slate-200"></div>

                    <!-- Section 4: Validation & Follow-up -->
                    <div>
                        <h3 class="text-lg font-semibold text-green-600 mb-4 flex items-center gap-2">
                            <i class="fa-solid fa-calendar-check"></i> Dates & Validations
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4">
                            <div class="form-group">
                                <label>Registration Date</label>
                                <input type="date" name="date " class="input-field">
                            </div>
                            <div class="form-group">
                                <label>V1</label>
                                <input type="date" name="V1" class="input-field">
                            </div>
                            <div class="form-group">
                                <label>V2</label>
                                <input type="date" name="V2" class="input-field">
                            </div>
                            <div class="form-group">
                                <label>V3</label>
                                <input type="date" name="V3" class="input-field">
                            </div>
                            <div class="form-group">
                                <label>V4</label>
                                <input type="date" name="V4" class="input-field">
                            </div>
                            <div class="form-group">
                                <label>V5</label>
                                <input type="date" name="V5" class="input-field">
                            </div>
                        </div>
                    </div>

                    <div class="h-px bg-slate-200"></div>

                    <!-- Section 5: Outcome -->
                    <div>
                        <h3 class="text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2">
                            <i class="fa-solid fa-heart-pulse"></i> Outcome
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div class="form-group">
                                <label>Survival Status</label>
                                <select name="Servival Status" class="input-field" onchange="toggleDeathFields(this)">
                                    <option value="">Select...</option>
                                    <option value="Alive">Alive</option>
                                    <option value="Died">Died</option>
                                </select>
                            </div>
                            <div class="form-group death-field hidden">
                                <label>Date of death</label>
                                <input type="date" name="Date of death" class="input-field">
                            </div>
                            <div class="form-group death-field hidden">
                                <label>Place of death</label>
                                <select name="Place of death" class="input-field">
                                    <option value="">Select...</option>
                                    <option value="AVH">AVH</option>
                                    <option value="House">House</option>
                                    <option value="Other Hospital">Other Hospital</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Actions -->
                    <div class="flex justify-end pt-4 gap-4">
                        <button type="button" onclick="document.getElementById('reg-form').reset()"
                            class="px-6 py-3 rounded-xl text-slate-500 hover:bg-slate-100 transition-colors font-medium">Clear</button>
                        <button type="submit"
                            class="px-8 py-3 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-bold shadow-lg shadow-blue-500/30 hover:shadow-blue-500/50 transform hover:-translate-y-1 transition-all flex items-center gap-2">
                            <i class="fa-solid fa-plus"></i> Register Patient
                        </button>
                    </div>
                </form>
            </div>
        </section>

        <!-- List Section -->
        <section id="list" class="page-section hidden animate-fade-in">
            <header class="mb-8 flex flex-col md:flex-row justify-between items-start md:items-end gap-4">
                <div>
                    <h1 class="text-3xl font-display font-bold text-slate-900">Patient List</h1>
                    <p class="text-slate-500">Manage and transfer patients</p>
                </div>

                <!-- Filters -->
                <div class="flex flex-wrap gap-3 items-center">

                    <!-- Column Picker -->
                    <div class="relative group z-10">
                        <button onclick="document.getElementById('col-picker').classList.toggle('hidden')"
                            class="px-4 py-2 rounded-xl bg-white border border-slate-200 text-slate-600 hover:text-blue-600 font-medium text-sm flex items-center gap-2 shadow-sm">
                            <i class="fa-solid fa-table-columns"></i> Columns
                        </button>
                        <div id="col-picker"
                            class="absolute right-0 top-full mt-2 w-48 bg-white rounded-xl shadow-xl border border-slate-100 p-3 hidden grid grid-cols-1 gap-2">
                            <label
                                class="flex items-center gap-2 text-sm text-slate-700 cursor-pointer hover:bg-slate-50 p-1 rounded">
                                <input type="checkbox" data-col="visits" checked class="col-toggle accent-blue-600"
                                    onchange="renderPatientLists()">
                                No. of Visits
                            </label>
                            <label
                                class="flex items-center gap-2 text-sm text-slate-700 cursor-pointer hover:bg-slate-50 p-1 rounded">
                                <input type="checkbox" data-col="stage" class="col-toggle accent-blue-600"
                                    onchange="renderPatientLists()">
                                Stage
                            </label>
                            <label
                                class="flex items-center gap-2 text-sm text-slate-700 cursor-pointer hover:bg-slate-50 p-1 rounded">
                                <input type="checkbox" data-col="ecog" class="col-toggle accent-blue-600"
                                    onchange="renderPatientLists()">
                                ECOG
                            </label>
                            <label
                                class="flex items-center gap-2 text-sm text-slate-700 cursor-pointer hover:bg-slate-50 p-1 rounded">
                                <input type="checkbox" data-col="referral" class="col-toggle accent-blue-600"
                                    onchange="renderPatientLists()">
                                Referral Site
                            </label>
                            <label
                                class="flex items-center gap-2 text-sm text-slate-700 cursor-pointer hover:bg-slate-50 p-1 rounded">
                                <input type="checkbox" data-col="survival" class="col-toggle accent-blue-600"
                                    onchange="renderPatientLists()">
                                Survival Status
                            </label>
                        </div>
                    </div>

                    <div class="relative group">
                        <i
                            class="fa-solid fa-location-dot absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 group-focus-within:text-blue-500 transition-colors"></i>
                        <input type="text" id="filter-area"
                            class="pl-9 pr-4 py-2 rounded-xl border border-slate-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-100 outline-none shadow-sm transition-all"
                            placeholder="Filter by Area...">
                    </div>
                    <div class="relative group">
                        <i
                            class="fa-solid fa-search absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 group-focus-within:text-blue-500 transition-colors"></i>
                        <input type="text" id="filter-search"
                            class="pl-9 pr-4 py-2 rounded-xl border border-slate-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-100 outline-none shadow-sm transition-all"
                            placeholder="Search name, ID...">
                    </div>
                </div>
            </header>

            <!-- AREA GRID VIEW -->
            <div id="area-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 animate-fade-in">
                <!-- Cards Injected via JS -->
                <div class="col-span-full text-center text-slate-400 py-12">
                    <i class="fa-solid fa-spinner fa-spin text-2xl mb-2"></i>
                    <p>Loading Areas...</p>
                </div>
            </div>

            <!-- AREA DETAIL VIEW (Hidden by default) -->
            <div id="area-detail-view" class="hidden animate-slide-up">
                <!-- Back Header -->
                <div class="flex items-center gap-4 mb-6">
                    <button onclick="closeAreaDetail()"
                        class="p-2 rounded-lg hover:bg-slate-100 text-slate-500 hover:text-slate-800 transition-colors group">
                        <i class="fa-solid fa-arrow-left text-lg group-hover:-translate-x-1 transition-transform"></i>
                    </button>
                    <div>
                        <h2 id="area-detail-title" class="text-2xl font-display font-bold text-slate-800">Area Name</h2>
                        <p class="text-sm text-slate-500">Patient Details</p>
                    </div>
                </div>

                <!-- Died Patients Table (Collapsible) -->
                <div class="mb-4">
                    <button onclick="toggleDiedSection()"
                        class="w-full flex items-center justify-between p-4 bg-slate-100 rounded-xl hover:bg-slate-200 transition-colors text-slate-500 font-bold group">
                        <span class="flex items-center gap-2">
                            <i class="fa-solid fa-ribbon text-slate-400"></i> Passed Away
                            <span id="died-badge-count"
                                class="text-xs bg-slate-200 text-slate-500 px-2 py-0.5 rounded-full ml-2">Counts:
                                0</span>
                        </span>
                        <i id="died-arrow" class="fa-solid fa-chevron-down transition-transform duration-300"></i>
                    </button>

                    <div id="died-section-content" class="hidden mt-4 animate-fade-in">
                        <div
                            class="glass-card rounded-2xl border border-white/50 shadow-lg overflow-hidden bg-slate-50/50">
                            <div class="overflow-x-auto">
                                <table class="w-full text-left opacity-75">
                                    <thead class="bg-slate-100/50 border-b border-slate-200">
                                        <tr id="table-header-row-died">
                                            <!-- Headers Injected via JS -->
                                        </tr>
                                    </thead>
                                    <tbody id="died-patients-body" class="divide-y divide-slate-200">
                                        <!-- JS Injected Rows -->
                                    </tbody>
                                </table>
                            </div>
                            <div
                                class="p-4 border-t border-slate-100 bg-slate-100/30 flex justify-between items-center text-sm text-slate-500">
                                <span id="showing-count-died">Showing 0 deceased patients</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Active Patients Table -->
                <div class="mb-8">
                    <h2 class="text-lg font-bold text-slate-800 mb-4 flex items-center gap-2">
                        <i class="fa-solid fa-heart-pulse text-green-500"></i> Active Patients
                    </h2>
                    <div class="glass-card rounded-2xl border border-white/50 shadow-lg overflow-hidden">
                        <div class="overflow-x-auto">
                            <table class="w-full text-left">
                                <thead class="bg-slate-50/50 border-b border-slate-100">
                                    <tr id="table-header-row-active">
                                        <!-- Headers Injected via JS -->
                                    </tr>
                                </thead>
                                <tbody id="active-patients-body" class="divide-y divide-slate-100">
                                    <tr>
                                        <td colspan="6" class="p-8 text-center text-slate-400">Loading data...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div
                            class="p-4 border-t border-slate-50 bg-slate-50/30 flex justify-between items-center text-sm text-slate-500">
                            <span id="showing-count-active">Showing 0 active patients</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Analysis Section -->
        <section id="analysis" class="page-section hidden animate-fade-in">
            <header class="mb-8">
                <h1 class="text-3xl font-display font-bold text-slate-900">Advanced Analysis</h1>
                <p class="text-slate-500">Explore relationships between variables</p>
            </header>

            <!-- Controls -->
            <div class="glass-card p-6 rounded-2xl mb-8">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="form-group">
                        <label class="block text-sm font-medium text-slate-700 mb-1">Variable 1 (X-Axis / Rows)</label>
                        <select id="analysis-var1" class="input-field" onchange="renderAnalysis()">
                            <option value="Gender">Gender</option>
                            <option value="Diagnosis">Diagnosis</option>
                            <option value="Adress">Address (Area)</option>
                            <option value="Intent of care">Intent of Care</option>
                            <option value="Stage of Disease">Stage of Disease</option>
                            <option value="ECOG">ECOG Performance</option>
                            <option value="Site of Referral">Referral Site</option>
                            <option value="Servival Status">Survival Status</option>
                            <option value="priority">Priority Level</option>
                            <option value="number of visits">Visits Count</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="block text-sm font-medium text-slate-700 mb-1">Variable 2 (Legend /
                            Columns)</label>
                        <select id="analysis-var2" class="input-field" onchange="renderAnalysis()">
                            <option value="">(None - Single Variable)</option>
                            <option value="Gender">Gender</option>
                            <option value="Diagnosis">Diagnosis</option>
                            <option value="Adress">Address (Area)</option>
                            <option value="Intent of care">Intent of Care</option>
                            <option value="Stage of Disease">Stage of Disease</option>
                            <option value="ECOG">ECOG Performance</option>
                            <option value="Site of Referral">Referral Site</option>
                            <option value="Servival Status">Survival Status</option>
                            <option value="priority">Priority Level</option>
                        </select>
                    </div>
                    <div class="flex items-end">
                        <div class="w-full p-4 bg-slate-50 rounded-xl border border-slate-200">
                            <div class="text-xs text-slate-400 font-bold uppercase tracking-wider mb-1">Statistical
                                Significance (Chi-Square)</div>
                            <div id="stats-p-value" class="text-lg font-bold text-slate-700">--</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Visualization -->
            <div class="glass-card p-6 rounded-2xl mb-8 relative">
                <h3 class="text-lg font-bold text-slate-800 mb-4">Visualization</h3>
                <div class="relative h-[400px] w-full">
                    <canvas id="analysis-chart"></canvas>
                </div>
            </div>

            <!-- Pivot Table -->
            <div class="glass-card p-6 rounded-2xl">
                <h3 class="text-lg font-bold text-slate-800 mb-4">Data Table</h3>
                <div class="overflow-x-auto">
                    <table class="w-full text-left border-collapse" id="analysis-table">
                        <!-- Dynamic Content -->
                    </table>
                </div>
            </div>
        </section>

    </main>

    <!-- Settings Modal -->
    <div id="settings-modal" class="fixed inset-0 z-[60] hidden">
        <div class="absolute inset-0 bg-slate-900/20 backdrop-blur-sm transition-opacity" onclick="closeSettings()">
        </div>
        <div class="absolute right-0 top-0 h-full w-full max-w-sm bg-white shadow-2xl p-6 transform transition-transform translate-x-full"
            id="settings-panel">
            <h2 class="text-2xl font-bold mb-6">Settings</h2>

            <div class="space-y-4">
                <div class="form-group">
                    <label class="block text-sm font-medium text-slate-700 mb-1">P1 App URL (Target)</label>
                    <input type="text" id="p1-url" class="input-field text-xs font-mono"
                        placeholder="https://script.google.com/..."
                        value="https://script.google.com/macros/s/AKfycbxJ0bG4MEptJCL_4057PM1UkFXrVSp5Vyydrq4ZvAUzGt3-gqyGq4aV1UhRpi90tszK/exec">
                    <p class="text-xs text-slate-400 mt-1">URL where patients are transferred to.</p>
                </div>

                <div class="form-group">
                    <label class="block text-sm font-medium text-slate-700 mb-1">HomeVisits App URL (Source)</label>
                    <input type="text" id="hv-url" class="input-field text-xs font-mono"
                        placeholder="Paste YOUR script url here...">
                    <p class="text-xs text-slate-400 mt-1">The Cloud Backend for this app.</p>
                </div>
            </div>

            <button onclick="saveSettings()"
                class="w-full mt-8 py-3 bg-blue-600 text-white rounded-xl font-bold hover:bg-blue-700 transition-colors">Save
                & Close</button>
        </div>
    </div>

    <!-- Mark Died Modal -->
    <div id="died-modal" class="fixed inset-0 z-[70] hidden flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-slate-900/40 backdrop-blur-md transition-opacity" onclick="closeDiedModal()">
        </div>
        <div
            class="glass-card bg-white p-8 rounded-3xl shadow-2xl w-full max-w-md relative z-10 transform transition-all scale-100">
            <h3 class="text-2xl font-bold text-slate-800 mb-2">Mark as Deceased</h3>
            <p class="text-slate-500 mb-6" id="died-modal-patient-name">Patient Name</p>

            <form id="died-form" class="space-y-4">
                <div class="form-group">
                    <label class="block text-sm font-medium text-slate-700 mb-1">Date of Death</label>
                    <input type="date" id="died-date" required class="input-field">
                </div>

                <div class="form-group">
                    <label class="block text-sm font-medium text-slate-700 mb-1">Place of Death</label>
                    <select id="died-place" required class="input-field">
                        <option value="">Select Place...</option>
                        <option value="AVH">AVH</option>
                        <option value="House">House</option>
                        <option value="Other Hospital">Other Hospital</option>
                    </select>
                </div>

                <div class="flex gap-3 mt-8">
                    <button type="button" onclick="closeDiedModal()"
                        class="flex-1 py-3 rounded-xl border border-slate-200 text-slate-600 font-medium hover:bg-slate-50 transition-colors">Cancel</button>
                    <button type="submit"
                        class="flex-1 py-3 rounded-xl bg-slate-800 text-white font-bold hover:bg-slate-900 transition-colors shadow-lg shadow-slate-500/30">Confirm</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/api.js"></script>
    <script src="js/app.js"></script>
</body>

</html>